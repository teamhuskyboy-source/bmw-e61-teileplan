<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BMW E61 525xd – Teileliste</title>

<style>
body { font-family: Arial, sans-serif; margin:0; background:#f2f2f2; }
header { background:#111; color:#fff; padding:20px; text-align:center; }

.container { padding:15px; }

input, select, button {
  width:100%;
  padding:10px;
  margin:5px 0;
  border-radius:8px;
  border:1px solid #ccc;
  font-size:16px;
}

button {
  background:#3b82f6;
  color:#fff;
  border:none;
}

.part {
  background:#3b82f6;
  color:#fff;
  padding:15px;
  border-radius:14px;
  margin-bottom:10px;
  position:relative;
}

.part small { display:block; opacity:.9; }

.star {
  position:absolute;
  right:15px;
  top:15px;
  font-size:18px;
  color:#facc15;
  cursor:pointer;
}

.details {
  background:#fff;
  color:#000;
  padding:12px;
  border-left:5px solid #3b82f6;
  border-radius:10px;
  margin-top:10px;
  display:none;
}
</style>
</head>

<body>

<header>
  <h1>BMW E61 525xd – Teileliste</h1>
  <p>Suche, filtere oder füge neue Teile hinzu</p>
</header>

<div class="container">

  <!-- Suche & Filter -->
  <input id="search" placeholder="Teil suchen...">
  <select id="categoryFilter">
    <option value="">Alle Kategorien</option>
    <option>Motor</option>
    <option>Getriebe</option>
    <option>Abgasanlage</option>
    <option>Kühlsystem</option>
    <option>Kraftstoffsystem</option>
    <option>Elektrik</option>
    <option>Steuergeräte</option>
    <option>Fahrwerk</option>
    <option>Bremsen</option>
    <option>Karosserie außen</option>
    <option>Innenraum</option>
    <option>Beleuchtung</option>
    <option>Antrieb</option>
  </select>

  <!-- Teil hinzufügen -->
  <h3>Teil hinzufügen</h3>
  <input id="newName" placeholder="Teilname">
  <input id="newCategory" placeholder="Kategorie">
  <input id="newOem" placeholder="OEM Nummer">
  <input id="newDesc" placeholder="Beschreibung">
  <button onclick="addPart()">Hinzufügen</button>

  <div id="list"></div>

</div>

<script>
let parts = JSON.parse(localStorage.getItem("parts")) || [
  {name:"Motorhaube", category:"Karosserie außen", oem:"41617111385", desc:"Motorhaube Touring"},
  {name:"Kotflügel", category:"Karosserie außen", oem:"41357133241", desc:"Kotflügel vorne links"},
  {name:"Tür vorne links", category:"Karosserie außen", oem:"41517202015", desc:"Vordertür links"},
  {name:"Heckklappe", category:"Karosserie außen", oem:"41627111391", desc:"Heckklappe Touring"},
  {name:"Scheinwerfer", category:"Beleuchtung", oem:"63117181293", desc:"Xenon Scheinwerfer links"},
  {name:"Rücklicht", category:"Beleuchtung", oem:"63217181297", desc:"Rückleuchte rechts"},
  {name:"Sitz", category:"Innenraum", oem:"52107188367", desc:"Komfortsitz Fahrer"}
];

let favorites = JSON.parse(localStorage.getItem("favorites") || "[]");

function render() {
  let search = document.getElementById("search").value.toLowerCase();
  let cat = document.getElementById("categoryFilter").value;
  let list = document.getElementById("list");
  list.innerHTML = "";

  parts.filter(p => 
    (!cat || p.category === cat) &&
    (p.name.toLowerCase().includes(search) || (p.oem || "").includes(search))
  ).forEach((p, i) => {

    let fav = favorites.includes(p.oem || p.name);

    let oem = p.oem && p.oem.trim() ? p.oem : "– nicht hinterlegt –";
    let desc = p.desc && p.desc.trim() ? p.desc : "– nicht hinterlegt –";

    let div = document.createElement("div");
    div.className = "part";
    div.innerHTML = `
      <b>${p.name}</b>
      <small>${p.category}</small>
      <span class="star" onclick="toggleFav('${p.oem || p.name}', event)">${fav ? "★" : "☆"}</span>
      <div class="details" id="d${i}">
        <b>OEM:</b> ${oem}<br>
        <b>Beschreibung:</b> ${desc}
      </div>
    `;

    div.onclick = () => {
      let d = document.getElementById("d" + i);
      d.style.display = d.style.display === "block" ? "none" : "block";
    };

    list.appendChild(div);
  });
}

function toggleFav(id, event) {
  event.stopPropagation();
  if (favorites.includes(id))
    favorites = favorites.filter(f => f !== id);
  else favorites.push(id);

  localStorage.setItem("favorites", JSON.stringify(favorites));
  render();
}

function addPart() {
  let n = document.getElementById("newName").value.trim();
  let c = document.getElementById("newCategory").value.trim();
  let o = document.getElementById("newOem").value.trim();
  let d = document.getElementById("newDesc").value.trim();

  if (!n || !c) return alert("Mindestens Name und Kategorie angeben");

  parts.push({
    name: n,
    category: c,
    oem: o || "",
    desc: d || ""
  });

  document.getElementById("newName").value = "";
  document.getElementById("newCategory").value = "";
  document.getElementById("newOem").value = "";
  document.getElementById("newDesc").value = "";

  localStorage.setItem("parts", JSON.stringify(parts));
  render();
}

document.getElementById("search").oninput = render;
document.getElementById("categoryFilter").onchange = render;

render();
</script>

</body>
</html>
