<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>BMW E61 Teileliste</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Arial, sans-serif;
  background: #f2f2f7;
  margin: 0;
}

header {
  background: #111;
  color: white;
  padding: 20px;
  text-align: center;
}

.container {
  padding: 15px;
  max-width: 700px;
  margin: auto;
}

input, select, textarea, button {
  width: 100%;
  padding: 12px;
  margin: 8px 0;
  border-radius: 10px;
  border: 1px solid #ccc;
  font-size: 16px;
}

button {
  background: #3b82f6;
  color: white;
  border: none;
  cursor: pointer;
}

button.secondary {
  background: #888;
}

button.danger {
  background: #e11d48;
}

.part {
  background: #3b82f6;
  color: white;
  border-radius: 15px;
  padding: 15px;
  margin: 10px 0;
  position: relative;
}

.part small {
  opacity: 0.85;
}

.star {
  position: absolute;
  right: 45px;
  top: 15px;
  font-size: 22px;
  color: gold;
  cursor: pointer;
}

.delete-btn {
  position: absolute;
  right: 10px;
  top: 12px;
  font-size: 18px;
  background: none;
  border: none;
  color: white;
  cursor: pointer;
}

.panel {
  background: white;
  border-left: 4px solid #3b82f6;
  padding: 12px;
  border-radius: 10px;
  margin-top: 10px;
}
</style>
</head>

<body>

<header>
  <h1>Teileliste BMW E61</h1>
  <p>Suche, filtere oder f√ºge neue Teile hinzu</p>
</header>

<div class="container">

  <input id="vinInput" placeholder="VIN eingeben">
  <input id="searchInput" placeholder="Teil suchen..." oninput="renderParts()">

  <select id="categoryFilter" onchange="renderParts()">
    <option value="">Alle Kategorien</option>
    <option>Motor</option>
    <option>Getriebe</option>
    <option>Kraftstoff</option>
    <option>Abgasanlage</option>
    <option>K√ºhlsystem</option>
    <option>Bremsen</option>
    <option>Elektrik</option>
    <option>Karosserie au√üen</option>
    <option>Innenraum</option>
    <option>Beleuchtung</option>
    <option>Steuerger√§te</option>
  </select>

  <button class="secondary" onclick="removeDuplicates()">Doppelte Teile entfernen</button>

  <h3>Teil hinzuf√ºgen</h3>
  <input id="nameInput" placeholder="Teilname">
  <input id="categoryInput" placeholder="Kategorie">
  <input id="oemInput" placeholder="OEM Nummer">
  <textarea id="descInput" placeholder="Beschreibung"></textarea>
  <button onclick="addPart()">Hinzuf√ºgen</button>

  <div id="partsList"></div>
  <div id="infoPanel" class="panel" style="display:none;"></div>

</div>

<script>
let parts = [
  {name:"Zylinderkopf", category:"Motor", oem:"11127806100", desc:"M57 Diesel Zylinderkopf"},
  {name:"Turbolader", category:"Motor", oem:"11657802588", desc:"Abgasturbolader"},
  {name:"Injektor", category:"Kraftstoff", oem:"13537805430", desc:"Common-Rail Injektor"}
];

function addPart() {
  const name = nameInput.value.trim();
  const category = categoryInput.value.trim();
  const oem = oemInput.value.trim();
  const desc = descInput.value.trim();

  if (!name || !category) {
    alert("Name und Kategorie sind Pflicht!");
    return;
  }

  // üîí Duplikate verhindern (Name + Kategorie)
  const exists = parts.some(p =>
    p.name.toLowerCase() === name.toLowerCase() &&
    p.category.toLowerCase() === category.toLowerCase()
  );

  if (exists) {
    alert("Dieses Teil existiert bereits!");
    return;
  }

  parts.push({name, category, oem, desc});
  nameInput.value = "";
  categoryInput.value = "";
  oemInput.value = "";
  descInput.value = "";

  renderParts();
}

function deletePart(index) {
  if (!confirm("Teil wirklich l√∂schen?")) return;
  parts.splice(index, 1);
  renderParts();
  infoPanel.style.display = "none";
}

function removeDuplicates() {
  const seen = {};
  parts = parts.filter(p => {
    const key = p.name.toLowerCase() + "|" + p.category.toLowerCase();
    if (seen[key]) return false;
    seen[key] = true;
    return true;
  });

  renderParts();
  alert("Doppelte Teile wurden entfernt.");
}

function renderParts() {
  const search = searchInput.value.toLowerCase();
  const category = categoryFilter.value;

  partsList.innerHTML = "";

  parts.forEach((p, i) => {
    if (
      (search && !p.name.toLowerCase().includes(search)) ||
      (category && p.category !== category)
    ) return;

    const div = document.createElement("div");
    div.className = "part";
    div.innerHTML = `
      <strong>${p.name}</strong><br>
      <small>${p.category}</small><br>
      <small>Status: undefined</small>
      <span class="star">‚òÜ</span>
      <button class="delete-btn" onclick="deletePart(${i})">‚ùå</button>
    `;

    div.onclick = (e) => {
      if (e.target.classList.contains("delete-btn")) return;
      showInfo(p);
    };

    partsList.appendChild(div);
  });
}

function showInfo(p) {
  infoPanel.style.display = "block";
  infoPanel.innerHTML = `
    <strong>Name:</strong> ${p.name}<br>
    <strong>Kategorie:</strong> ${p.category}<br>
    <strong>OEM:</strong> ${p.oem || "-"}<br>
    <strong>Beschreibung:</strong> ${p.desc || "-"}
  `;
}

renderParts();
</script>

</body>
</html>
