<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>BMW E61 525xd – Teileliste</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  font-family: Arial, sans-serif;
  margin: 0;
  background: #f4f4f4;
}

header {
  background: #111;
  color: #fff;
  padding: 20px;
  text-align: center;
}

#controls {
  padding: 10px;
  text-align: center;
}

#search {
  width: 90%;
  padding: 10px;
  font-size: 16px;
  border-radius: 8px;
  border: 1px solid #ccc;
  margin-bottom: 10px;
}

button.sort {
  background: #3b82f6;
  color: white;
  border: none;
  border-radius: 10px;
  padding: 10px 14px;
  margin: 5px;
  font-size: 14px;
}

#list {
  padding: 10px;
}

.item {
  border-radius: 14px;
  padding: 14px;
  margin-bottom: 10px;
  display: flex;
  align-items: center;
  color: white;
}

.item.ok { background: #16a34a; }
.item.warn { background: #f59e0b; }
.item.bad { background: #dc2626; }

.item-info {
  flex-grow: 1;
}

.item-title {
  font-size: 18px;
  font-weight: bold;
}

.item-sub {
  font-size: 14px;
  opacity: 0.9;
}

.buttons {
  display: flex;
  align-items: center;
  gap: 10px;
}

button.star {
  background: #facc15;
  border: none;
  border-radius: 50%;
  font-size: 18px;
  width: 36px;
  height: 36px;
}

button.status {
  background: transparent;
  border: 2px solid white;
  border-radius: 10px;
  color: white;
  padding: 6px 10px;
  font-size: 14px;
}

#panel {
  background: #fff;
  margin: 10px;
  padding: 12px;
  border-left: 4px solid #3b82f6;
}
</style>
</head>

<body>

<header>
  <h1>Teileliste</h1>
  <p>Tippe auf ein Teil</p>
</header>

<div id="controls">
  <input id="search" placeholder="Suche nach Name, Gruppe oder OEM…" oninput="renderList()">
  <br>
  <button class="sort" onclick="sortBy('name')">Sortieren nach Name</button>
  <button class="sort" onclick="sortBy('gruppe')">Sortieren nach Gruppe</button>
  <button class="sort" onclick="sortBy('status')">Sortieren nach Status</button>
</div>

<div id="list"></div>

<div id="panel">
  Tippe auf ein Teil
</div>

<script>
let teile = [
  { name:"Zylinderkopf", oem:"11127806100", gruppe:"Motor", beschreibung:"M57 Diesel Zylinderkopf", fav:false, status:"OK" },
  { name:"Turbolader", oem:"11657802588", gruppe:"Turbo", beschreibung:"Abgasturbolader", fav:false, status:"OK" },
  { name:"Wasserpumpe", oem:"11517788826", gruppe:"Kühlsystem", beschreibung:"Kühlmittelpumpe", fav:false, status:"OK" },
  { name:"Bremsscheibe VA", oem:"34116864058", gruppe:"Bremsen", beschreibung:"Belüftete Bremsscheibe vorne", fav:false, status:"OK" },
  { name:"Injektor", oem:"13537805430", gruppe:"Kraftstoff", beschreibung:"Common-Rail Injektor", fav:false, status:"OK" },
  { name:"Kardanwelle", oem:"26107570956", gruppe:"Antrieb", beschreibung:"xDrive Kardanwelle", fav:false, status:"OK" },
  { name:"Rücklicht", oem:"63217160793", gruppe:"Karosserie", beschreibung:"Rückleuchte rechts", fav:false, status:"OK" },
  { name:"Batterie", oem:"61217586967", gruppe:"Elektrik", beschreibung:"Starterbatterie", fav:false, status:"OK" }
];

let currentSort = null;

function renderList() {
  const list = document.getElementById("list");
  const search = document.getElementById("search").value.toLowerCase();
  list.innerHTML = "";

  let filtered = teile.filter(t =>
    t.name.toLowerCase().includes(search) ||
    t.gruppe.toLowerCase().includes(search) ||
    t.oem.includes(search)
  );

  filtered.forEach((t, i) => {
    const div = document.createElement("div");
    div.className = "item " + statusClass(t.status);

    const info = document.createElement("div");
    info.className = "item-info";
    info.innerHTML = `
      <div class="item-title">${t.name}</div>
      <div class="item-sub">${t.gruppe}</div>
    `;
    info.onclick = () => show(i);

    const buttons = document.createElement("div");
    buttons.className = "buttons";

    const star = document.createElement("button");
    star.className = "star";
    star.innerText = t.fav ? "★" : "☆";
    star.onclick = (e) => {
      e.stopPropagation();
      toggleFav(i);
    };

    const statusBtn = document.createElement("button");
    statusBtn.className = "status";
    statusBtn.innerText = t.status;
    statusBtn.onclick = (e) => {
      e.stopPropagation();
      toggleStatus(i);
    };

    buttons.appendChild(star);
    buttons.appendChild(statusBtn);

    div.appendChild(info);
    div.appendChild(buttons);

    list.appendChild(div);
  });
}

function statusClass(status) {
  if (status === "OK") return "ok";
  if (status === "WARN") return "warn";
  if (status === "DEF") return "bad";
  return "ok";
}

function show(i) {
  const t = teile[i];
  document.getElementById("panel").innerHTML = `
    <strong>Name:</strong> ${t.name}<br>
    <strong>OEM:</strong> ${t.oem}<br>
    <strong>Gruppe:</strong> ${t.gruppe}<br>
    <strong>Status:</strong> ${t.status}<br>
    <strong>Beschreibung:</strong> ${t.beschreibung}
  `;
}

function toggleFav(i) {
  teile[i].fav = !teile[i].fav;
  renderList();
}

function toggleStatus(i) {
  const order = ["OK", "WARN", "DEF"];
  const idx = order.indexOf(teile[i].status);
  teile[i].status = order[(idx + 1) % order.length];
  renderList();
}

function sortBy(key) {
  currentSort = key;
  teile.sort((a,b) => {
    if (a[key] < b[key]) return -1;
    if (a[key] > b[key]) return 1;
    return 0;
  });
  renderList();
}

renderList();
</script>

</body>
</html>
